/*! Stapes UI - v0.0.1 - 2014-05-19
* Copyright (c) 2014 Marco Solazzi; Licensed MIT */
!function(a,b){"function"==typeof define&&define.amd?define(["stapes","jquery"],b):"object"==typeof exports?module.exports=b(require("stapes"),require("jquery")):a.Stapes.Ui=b(a.Stapes,a.jQuery)}(this,function(a,b){var c={},d=!0;c.uid=0,c.Config={DEBUG:!1,VERBOSE:!1},c.vent=a.mixinEvents(),c.log=function(){console.log.apply(console,arguments)},c.init=function(e){b.extend(c.Config,e||{}),c.Config.DEBUG&&(a.on("all",function(a,b){c.log("stapes-ui: "+b.type,a||null,b)}),d=!c.Config.VERBOSE),c.vent.emit("bootstrap",c.Config)},c.addInitializer=function(a,d){var e;e=b.isFunction(a)?a:function(c){var e=b(a);e&&e.length>0&&d.call(null,c,a,e)},c.vent.on("bootstrap",e)};var e=/([a-z]+)\s?:/gi,f=/\'/g,g=/\-+/;c.Sandbox=a.subclass({constructor:function(){return arguments.length>0&&this.register.apply(this,arguments),this.id="sui-sbox-"+ ++a.Ui.uid,this.$root=null,this},_registerWidget:function(a,c){var e=a.replace(g,""),f={active:!1};b.isFunction(c)?b.extend(f,{selector:"."+a,callback:c}):b.isPlainObject(c)?b.extend(f,c):b.error("Widget constructor not provided"),f._instances=[],this.set(e,f,d)},_updateWidget:function(a,b){this.set(a,b,d),this.emit("sandbox:active:"+a,b),this.emit("sandbox:active",b)},register:function(a,c){return b.isPlainObject(a)?b.each(a,b.proxy(this._registerWidget,this)):this._registerWidget(a,c),this},start:function(a){var c,d=this;c=this.$root=b(a||document),this.each(function(a,g){var h,i;a.active!==!0&&(h=c.find(a.selector),h&&h.length>0&&(i=h.not("[data-sui-skip],[data-sui-active]").get(),a._instances=b.map(i,function(c){var h,i=b(c),j=i.data("sui-"+g+"-conf")||{};return"string"===b.type(j)&&(j=j.replace(e,'"$1":').replace(f,'"'),j=b.parseJSON(j)||{}),j.$el=i,h=new a.callback(j,d).render(),i.data("sui-"+g,h).attr("data-sui-active",!0),h})),a.active=!0,this._updateWidget(g,a))}),this.emit("sandbox:start",this)},stop:function(){this.each(function(a,c){var d;if(a.active){for(;a._instances.length;)d=a._instances.pop(),b.isFunction(d.destroy)&&d.destroy.call(d);a.active=!1,this._updateWidget(c,a)}}),this.emit("sandbox:stop",this)}});var h=["$el","tagName","className"];c.Module=a.subclass({_options:{},_data:{},_configureProperty:function(a,b){this.options.hasOwnProperty(b)&&(this[b]=this.options[b])},constructor:function(a){this.options=b.extend({},this._options,a||{}),b.each(h,b.proxy(this._configureProperty,this)),this.set(b.extend({},this._data,a.data||{}),d),this.initialize.apply(this,arguments)},initialize:function(){},render:function(){return this},destroy:function(){}});var i=c.Module.subclass;return c.Module.subclass=function(){var a={constructor:c.Module.prototype.constructor};return a.push.apply(a,arguments),i.apply(c.Module,a)},c});